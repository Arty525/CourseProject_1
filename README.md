# CourseProject_1
Это курсовой проект по курсу "Разработчик на Python" от платформы Skypro

Данная программа является симулятором backend функций банковского приложения.

## Установка и запуск проекта
Для установки и запуска проекта у вас должны быть установлены IDE, Python 3, GitHub, Poetry, pytest, flake8,
black, mypy, isort
    
    - Клонируйте репозиторий командой 'git clone https://github.com/Arty525/EP_Skypro.git'
    - Запустите проект в своей IDE
    - Перейдите в src/main.py
    - Запустите файл main.py в вашей IDE

### Команды для запуска:

Запуск программы происходит при запуске модуля main.py
Далее программа запрашивает команды у пользователя, все доступные команды выводятся на экран.
Команды считываются со стандартного ввода с клавиатуры. При вводе неверной команды программа запрашивает повторный ввод.

## Используемые библиотеки
pandas, openpyxl, python-dotenv, requests

## Тестирование

В проекте используется pytest и Code coverage. 
Для запуска всех тестов используйте команду pytest.
Для проверки покрытия кода тестами используйте команды:

    pytest --cov - при активированном виртуальном окружении
    poetry run pytest --cov - для запуска через Poetry
    pytest --cov=src --cov-report=html - для вывода отчета о покрытии в html файл

## Список доступных функций

### excel_reader
Функция принимает на вход путь к файлу формата .xlsx и возвращает список словарей с данными из файла.

### get_currency_rates
Функция обращается к внешнему API и возвращает курсы валют из списка

### get_stock_prices
Функция обращается к внешнему API и возвращает курсы акций из списка\

### cards_collector
Функция принимает список банковских операций и возвращает сумму трат по картам

### top_transactions
Функция принимает список банковских операций и возвращает топ-5 транзакций по сумме платежа

### currency_rates
Функция возвращает стоимость валют из заданного списка через API

### main_page
Основная функция модуля views принимает на вход текущую дату и возвращает JSON-ответ содержащий расходы и кэшбек по
каждой карте, топ-5 транзакций по сумме платежа, курс валют и стоимость акций указанных в файле user_settings.json

Пример JSON-Ответа:

    {
    "greeting": "Добрый день",
    "cards": [
        {
        "last_digits": "5814",
        "total_spent": 1262.00,
        "cashback": 12.62
        },
        {
          "last_digits": "7512",
          "total_spent": 7.94,
          "cashback": 0.08
        }
      ],
      "top_transactions": [
        {
          "date": "21.12.2021",
          "amount": 1198.23,
          "category": "Переводы",
          "description": "Перевод Кредитная карта. ТП 10.2 RUR"
        },
        {
          "date": "20.12.2021",
          "amount": 829.00,
          "category": "Супермаркеты",
          "description": "Лента"
        },
        {
          "date": "20.12.2021",
          "amount": 421.00,
          "category": "Различные товары",
          "description": "Ozon.ru"
        },
        {
          "date": "16.12.2021",
          "amount": -14216.42,
          "category": "ЖКХ",
          "description": "ЖКУ Квартира"
        },
        {
          "date": "16.12.2021",
          "amount": 453.00,
          "category": "Бонусы",
          "description": "Кешбэк за обычные покупки"
        }
      ],
      "currency_rates": [
        {
          "currency": "USD",
          "rate": 73.21
        },
        {
          "currency": "EUR",
          "rate": 87.08
        }
      ],
      "stock_prices": [
        {
          "stock": "AAPL",
          "price": 150.12
        },
        {
          "stock": "AMZN",
          "price": 3173.18
        },
        {
          "stock": "GOOGL",
          "price": 2742.39
        },
        {
          "stock": "MSFT",
          "price": 296.71
        },
        {
          "stock": "TSLA",
          "price": 1007.08
        }
      ]
    }

### cashback_category
Функция возвращает JSON с анализом, сколько на каждой категории можно заработать кешбэка в указанном месяце года.

Пример JSON-Ответа:

    {
        "Категория 1": 1000,
        "Категория 2": 2000,
        "Категория 3": 500
    }

### spending_by_category
Функция возвращает список трат по заданной категории в заданном периоде

## Декораторы

### report
Декоратор записывает в файл результат работы функции
    
